<html>
<head>
<link href="style.css" rel="stylesheet" type="text/css">
</head>
<body>

<h1><a name="dirnode"> DirNode Module </a></h1>

<ul class="toc">
<li><a href="#mod_dep"> Module Dependencies </a></li>
<li><a href="#desc"> Description </a></li>
<li><a href="#dirnode_var"> DirNode Variables </a></li>
<li><a href="#dirnode_method"> DirNode Methods </a></li>
	<ul>
	<li><a href="#DirNode::DirNode"> DirNode::DirNode </a></li>
	<li><a href="#DirNode::~DirNode"> DirNode::~DirNode </a></li>
	<li><a href="#DirNode::get_attr"> DirNode::get_attr </a></li>
	<li><a href="#DirNode::update_attr"> DirNode::update_attr </a></li>
	<li><a href="#DirNode::update_child_attr"> DirNode::update_child_attr </a></li>
	<li><a href="#DirNode::dump"> DirNode::dump </a></li>
	<li><a href="#DirNode::is_dir"> DirNode::is_dir </a></li>
	<li><a href="#DirNode::is_link"> DirNode::is_link </a></li>
	<li><a href="#DirNode::is_file"> DirNode::is_file </a></li>
	<li><a href="#DirNode::INIT"> DirNode::INIT </a></li>
	<li><a href="#DirNode::GET_LINK_NAME"> DirNode::GET_LINK_NAME </a></li>
	<li><a href="#DirNode::INSERT"> DirNode::INSERT </a></li>
	<li><a href="#DirNode::INSERT_CHILD"> DirNode::INSERT_CHILD </a></li>
	<li><a href="#DirNode::UNLINK"> DirNode::UNLINK </a></li>
	<li><a href="#DirNode::REMOVE_CHILD_BY_NAME"> DirNode::REMOVE_CHILD_BY_NAME </a></li>
	</ul>
</ul>


<h2><a name="mod_dep"> Module Dependencies </h2>
<pre>
 Buffer
   *
   |
 DirNode

Legend:
^ : inheritance.
* : include.
</pre>


<h2><a name="desc"> Description </a></h2>
<p>
DirNode class handling attributes and link of node.
</p>

<h2><a name="dirnode_var"> DirNode Variables </a></h2>
<table class="class-var">
<tr>
	<th>Type</th><th>Name</th><th>Description</th>
</tr>
<tr>
	<td>int</td>
	<td>_mode</td>
	<td>Type and permission of node.</td>
</tr><tr>
	<td>int</td>
	<td>_uid</td>
	<td>User ID of node in file system.</td>
</tr><tr>
	<td>int</td>
	<td>_gid</td>
	<td>Group ID of node in file system.</td>
</tr><tr>
	<td>long</td>
	<td>_size</td>
	<td>Size of node.</td>
</tr><tr>
	<td>long</td>
	<td>_mtime</td>
	<td>Last modification time to the contents of file.</td>
</tr><tr>
	<td>long</td>
	<td>_ctime</td>
	<td>Last modification time to the attributes of node.</td>
</tr><tr>
	<td>Buffer</td>
	<td>_name</td>
	<td>Name of node.</td>
</tr><tr>
	<td>Buffer</td>
	<td>_linkname</td>
	<td>A real path if node is a symbolic link.</td>
</tr><tr>
	<td>DirNode*</td>
	<td>_next</td>
	<td>Pointer to the next node in the same directory.</td>
</tr><tr>
	<td>DirNode*</td>
	<td>_prev</td>
	<td>Pointer to the previous node in the same directory.</td>
</tr><tr>
	<td>DirNode*</td>
	<td>_child</td>
	<td>Pointer to the child node if this node is a directory.</td>
</tr><tr>
	<td>DirNode*</td>
	<td>_link</td>
	<td> Pointer to the real node object if this node is a symbolic link
to directory with the same root.</td>
</tr><tr>
	<td>DirNode*</td>
	<td>_parent</td>
	<td>Pointer to the parent directory.</td>
</tr>
</table>


<h2><a name="dirnode_method"> DirNode Methods </a></h2>

<h3><a name="DirNode::DirNode"><tt> DirNode::DirNode </tt></a></h3>
<table class="class-method">
<tr>
	<th>Code</th>
	<td colspan="3"> DirNode() </td>
</tr><tr>
	<th>Parameter</th>
	<td>-</td>
</tr><tr>
	<th>Return Value</th>
	<td>-</td>
</tr><tr>
	<th>Description</th>
	<td colspan="3"> DirNode constructor.</td>
</tr>
</table>

<h3><a name="DirNode::~DirNode"><tt> DirNode::~DirNode </tt></a></h3>
<table class="class-method">
<tr>
	<th>Code</th>
	<td colspan="3"> virtual ~DirNode() </td>
</tr><tr>
	<th>Parameter</th>
	<td>-</td>
</tr><tr>
	<th>Return Value</th>
	<td>-</td>
</tr><tr>
	<th>Description</th>
	<td colspan="3"> DirNode destructor. </td>
</tr>
</table>

<h3><a name="DirNode::get_attr"><tt> DirNode::get_attr </tt></a></h3>
<table class="class-method">
<tr>
	<th>Code</th>
	<td colspan="3"> int get_attr(const char* rpath, const char* name =
NULL) </td>
</tr><tr>
	<th rowspan="2">Parameter</th>
		<td><tt> rpath </tt></td>
		<td>:</td>
		<td> path to a node. </td>
	</tr><tr>
		<td><tt> name </tt></td>
		<td>:</td>
		<td> the basename of <tt>rpath</tt>, default to <tt>NULL</tt>.
		</td>
</tr><tr>
	<th rowspan="2"> Return Value </th>
		<td><tt> 0 </tt></td>
		<td>:</td>
		<td> success.</td>
	</tr><tr>
		<td><tt> -1 </tt></td>
		<td>:</td>
		<td> fail. </td>
</tr><tr>
	<th>Description</th>
	<td colspan="3"> Get attributes of node pointed by <tt>rpath</tt>.
	</td>
</tr>
</table>

<h3><a name="DirNode::update_attr"><tt> DirNode::update_attr </tt></a></h3>
<table class="class-method">
<tr>
	<th>Code</th>
	<td colspan="3"> int update_attr(DirNode* node, const char* rpath) </td>
</tr><tr>
	<th rowspan="2">Parameter</th>
		<td><tt> node </tt></td>
		<td>:</td>
		<td> a pointer to DirNode object that will be updated. </td>
	</tr><tr>
		<td><tt> rpath </tt></td>
		<td>:</td>
		<td> a path to the node in file system. </td>
</tr><tr>
	<th rowspan="5">Return Value</th>
		<td><tt> 3 </tt></td>
		<td>:</td>
		<td> success, content and attribute of node has been changed. </td>
	</tr><tr>
		<td><tt> 2 </tt></td>
		<td>:</td>
		<td> success, only attribute of node has been changed. </td>
	</tr><tr>
		<td><tt> 1 </tt></td>
		<td>:</td>
		<td> success, only content of node has been changed. </td>
	</tr><tr>
		<td><tt> 0 </tt></td>
		<td>:</td>
		<td> success, nothing changed. </td>
</tr><tr>
		<td><tt> -1 </tt></td>
		<td>:</td>
		<td> fail, system error. </td>
</tr><tr>
	<th>Description</th>
	<td colspan="3"> Update attribute of node if modification time or
attribute time has been changed.
	</td>
</tr>
</table>

<h3><a name="DirNode::update_child_attr"><tt> DirNode::update_child_attr </tt></a></h3>
<table class="class-method">
<tr>
	<th>Code</th>
	<td colspan="3"> int update_child_attr(DirNode** node, const char*
rpath, const char* name)</td>
</tr><tr>
	<th rowspan="3">Parameter</th>
		<td><tt> node </tt></td>
		<td>:</td>
		<td>return value, pointer to DirNode object.</td>
	</tr><tr>
		<td><tt> rpath </tt></td>
		<td>:</td>
		<td> a path that need to be updated. </td>
	</tr><tr>
		<td><tt> name </tt></td>
		<td>:</td>
		<td> the basename of <tt>rpath</tt></td>
</tr><tr>
	<th rowspan="4">Return Value</th>
		<td><tt>1</tt></td>
		<td>:</td>
		<td> success, child attribute change. </td>
	</tr><tr>
		<td><tt> 0 </tt></td>
		<td>:</td>
		<td> success, nothing changed. </td>
	</tr><tr>
		<td><tt> -1 </tt></td>
		<td>:</td>
		<td> fail, child with node name is <tt>name</tt> was not
found in directory caches.
		</td>
	</tr><tr>
		<td><tt> -2 </tt></td>
		<td>:</td>
		<td> fail, system error. </td>
</tr><tr>
	<th>Description</th>
	<td colspan="3"> Update attribute of child node <tt>name</tt>, if
change. </td>
</tr>
</table>

<h3><a name="DirNode::dump"><tt> DirNode::dump </tt></a></h3>
<table class="class-method">
<tr>
	<th>Code</th>
	<td colspan="3"> void dump(int space = 0) </td>
</tr><tr>
	<th>Parameter</th>
	<td><tt>space</tt></td>
	<td>:</td>
	<td> number of space for output format, default to 0. </td>
</tr><tr>
	<th>Return Value</th>
	<td>-</td>
</tr><tr>
	<th>Description</th>
	<td colspan="3"> Dump content of DirNode object to standard output. </td>
</tr>
</table>

<h3><a name="DirNode::is_dir"><tt> DirNode::is_dir </tt></a></h3>
<table class="class-method">
<tr>
	<th>Code</th>
	<td colspan="3"> inline int is_dir() </td>
</tr><tr>
	<th>Parameter</th>
	<td>-</td>
</tr><tr>
	<th rowspan="2"> Return Value </th>
		<td><tt> 1 </tt></td>
		<td>:</td>
		<td> true, node is a directory. </td>
	</tr><tr>
		<td><tt> 0 </tt></td>
		<td>:</td>
		<td> false, node is not a directory. </td>
</tr><tr>
	<th>Description</th>
	<td colspan="3"> Check if node is a directory or not. </td>
</tr>
</table>

<h3><a name="DirNode::is_link"><tt> DirNode::is_link </tt></a></h3>
<table class="class-method">
<tr>
	<th>Code</th>
	<td colspan="3"></td>
</tr><tr>
	<th>Parameter</th>
	<td>-</td>
</tr><tr>
	<th rowspan="2"> Return Value </th>
		<td><tt> 1 </tt></td>
		<td>:</td>
		<td> true, node is a symbolic link. </td>
	</tr><tr>
		<td><tt> 0 </tt></td>
		<td>:</td>
		<td> false, node is not a symbolic link. </td>
</tr><tr>
	<th>Description</th>
	<td colspan="3"> Check if node is a symbolic link or not. </td>
</tr>
</table>

<h3><a name="DirNode::is_file"><tt> DirNode::is_file </tt></a></h3>
<table class="class-method">
<tr>
	<th>Code</th>
	<td colspan="3"> inline int is_file() </td>
</tr><tr>
	<th>Parameter</th>
	<td>-</td>
</tr><tr>
	<th rowspan="2"> Return Value </th>
		<td><tt> 1 </tt></td>
		<td>:</td>
		<td> true, node is a regular file. </td>
	</tr><tr>
		<td><tt> 0 </tt></td>
		<td>:</td>
		<td> false, node is not a regular file. </td>
</tr><tr>
	<th>Description</th>
	<td colspan="3"> Check if node is a regular file or not. </td>
</tr>
</table>

<h3><a name="DirNode::INIT"><tt> DirNode::INIT </tt></a></h3>
<table class="class-method">
<tr>
	<th>Code</th>
	<td colspan="3"> static int INIT(DirNode** node, const char* rpath,
const char* path) </td>
</tr><tr>
	<th rowspan="3">Parameter</th>
		<td><tt> node </tt></td>
		<td>:</td>
		<td> return value, a new DirNode object. </td>
	</tr><tr>
		<td><tt> rpath </tt></td>
		<td>:</td>
		<td> a path to directory. </td>
	</tr><tr>
		<td><tt> path </tt></td>
		<td>:</td>
		<td> a basename of <tt>rpath</tt>. </td>
</tr><tr>
	<th rowspan="2"> Return Value </th>
		<td><tt> 0 </tt></td>
		<td>:</td>
		<td> success.</td>
	</tr><tr>
		<td><tt> -1 </tt></td>
		<td>:</td>
		<td> fail. </td>
</tr><tr>
	<th>Description</th>
	<td colspan="3"> Create and initialize a new DirNode object based on
<tt>rpath</tt>.  <tt>rpath</tt> is path to directory, I.e:
"<tt>../../x</tt>", where <tt>path</tt> is only contain "<tt>x</tt>".
	</td>
</tr>
</table>

<h3><a name="DirNode::GET_LINK_NAME"><tt> DirNode::GET_LINK_NAME </tt></a></h3>
<table class="class-method">
<tr>
	<th>Code</th>
	<td colspan="3"> static int GET_LINK_NAME(Buffer* linkname, const
char* path) </td>
</tr><tr>
	<th rowspan="2">Parameter</th>
		<td><tt> linkname </tt></td>
		<td>:</td>
		<td> return value, pointer to Buffer object where the real
path or name of symbolic link will be saved. </td>
	</tr><tr>
		<td><tt> path </tt></td>
		<td>:</td>
		<td> a path to node to check for link name. </td>
</tr><tr>
	<th rowspan="2"> Return Value </th>
		<td><tt> 0 </tt></td>
		<td>:</td>
		<td> success.</td>
	</tr><tr>
		<td><tt> -1 </tt></td>
		<td>:</td>
		<td> fail. </td>
</tr><tr>
	<th>Description</th>
	<td colspan="3"> Get a real path or real name of symbolic link
<tt>path</tt>.</td>
</tr>
</table>

<h3><a name="DirNode::INSERT"><tt> DirNode::INSERT </tt></a></h3>
<table class="class-method">
<tr>
	<th>Code</th>
	<td colspan="3"> static void INSERT(DirNode** list, DirNode* node) </td>
</tr><tr>
	<th rowspan="2">Parameter</th>
		<td><tt> list </tt></td>
		<td>:</td>
		<td> pointer to the head of list. </td>
	</tr><tr>
		<td><tt> node </tt></td>
		<td>:</td>
		<td> a new node that will be inserted to <tt>list</tt>. </td>
</tr><tr>
	<th>Return Value</th>
	<td>-</td>
</tr><tr>
	<th>Description</th>
	<td colspan="3"> Insert <tt>node</tt> to the list of DirNode
<tt>list</tt>, sort by node name.</td>
</tr>
</table>

<h3><a name="DirNode::INSERT_CHILD"><tt> DirNode::INSERT_CHILD </tt></a></h3>
<table class="class-method">
<tr>
	<th>Code</th>
	<td colspan="3"> static int INSERT_CHILD(DirNode* list, const char*
rpath, const char* name) </td>
</tr><tr>
	<th rowspan="3">Parameter</th>
		<td><tt> list </tt></td>
		<td>:</td>
		<td> pointer to list of DirNode object. </td>
	</tr><tr>
		<td><tt> rpath </tt></td>
		<td>:</td>
		<td> real path of node from the root directory. </td>
	</tr><tr>
</tr><tr>
	<th rowspan="2"> Return Value </th>
		<td><tt> 0 </tt></td>
		<td>:</td>
		<td> success.</td>
	</tr><tr>
		<td><tt> -1 </tt></td>
		<td>:</td>
		<td> fail. </td>
</tr><tr>
	<th>Description</th>
	<td colspan="3"> Create and initialize a new DirNode object based on
<tt>rpath</tt>, and insert it into the <tt>list</tt>.
	</td>
</tr>
</table>

<h3><a name="DirNode::UNLINK"><tt> DirNode::UNLINK </tt></a></h3>
<table class="class-method">
<tr>
	<th>Code</th>
	<td colspan="3"> static void UNLINK(DirNode** list, DirNode* node) </td>
</tr><tr>
	<th rowspan="2">Parameter</th>
		<td><tt> list </tt></td>
		<td>:</td>
		<td> pointer to the list of DirNode object. </td>
	</tr><tr>
		<td><tt> node </tt></td>
		<td>:</td>
		<td> pointer to DirNode object that will be removed from list.
		</td>
</tr><tr>
	<th>Return Value</th>
	<td>-</td>
</tr><tr>
	<th>Description</th>
	<td colspan="3"> Unlink <tt>node</tt> from <tt>list</tt>.</td>
</tr>
</table>

<h3><a name="DirNode::REMOVE_CHILD_BY_NAME"><tt> DirNode::REMOVE_CHILD_BY_NAME </tt></a></h3>
<table class="class-method">
<tr>
	<th>Code</th>
	<td colspan="3"> static int REMOVE_CHILD_BY_NAME(DirNode* list, const
char* name) </td>
</tr><tr>
	<th rowspan="2">Parameter</th>
		<td><tt> list </tt></td>
		<td>:</td>
		<td> pointer to DirNode object as the parent list of
directory. </td>
	</tr><tr>
		<td><tt> name </tt></td>
		<td>:</td>
		<td> name of node that will be removed. </td>
</tr><tr>
	<th rowspan="2"> Return Value </th>
		<td><tt> 0 </tt></td>
		<td>:</td>
		<td> success.</td>
	</tr><tr>
		<td><tt> -1 </tt></td>
		<td>:</td>
		<td> fail, child node with name is <tt>name</tt> is not found
in the list.
		</td>
</tr><tr>
	<th>Description</th>
	<td colspan="3"> Remove child node with name is <tt>name</tt> from
child node of <tt>list</tt>.
	</td>
</tr>
</table>


</body>
</html>
